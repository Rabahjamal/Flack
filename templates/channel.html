<!DOCTYPE html>
<html>
    <head>
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
      <script>
          document.addEventListener('DOMContentLoaded', () => {

              // Connect to websocket
              var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port);
              console.log(location.protocol + '//' + document.domain + ':' + location.port);

              // When connected, configure buttons
              socket.on('connect', () => {

                  document.querySelector('#sendbutton').onclick = function() {
                      const message_text = document.querySelector('#message_text').value;
                      console.log(message_text);
                      socket.emit('new message', {'message_text': message_text});
                  };
              });

              // When a new vote is announced, add to the unordered list
              socket.on('messages', data => {
                console.log("da5l")
                const li = document.createElement('li');
                var name = localStorage.getItem('displayName');
                li.innerHTML = `${name}: ${data}`;
                document.querySelector('#messages').append(li);
              });
          });
      </script>
      <title>Welcome to Flack</title>
  </head>
  <body>
      <h1>Welcome in {{ channel_name }} channel</h1>

      <ul id="messages">

      </ul>

      <!--<form id="form">
            <input id="message_text" autofocus name="message" placeholder="Enter your message" type="text">
            <!- - <input type="submit"> - ->
            <button id="submit-button"class="btn btn-primary">Submit</button>
      </form> -->
      <input type="text" id="message_text">
      <button id="sendbutton">Send</button>
  </body>
</html>
